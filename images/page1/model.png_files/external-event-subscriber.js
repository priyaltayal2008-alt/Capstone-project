(function(){function b(t){Object.defineProperty(t,"__esModule",{value:!0,configurable:!0})}function s(t,d,r,e){Object.defineProperty(t,d,{get:r,set:e,enumerable:!0,configurable:!0})}var E=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},n=E.parcelRequire94c2,_=n.register;_("2dXcK",function(t,d){b(t.exports),s(t.exports,"default",function(){return S});var r=n("dEa8z"),e=n("kHyIS"),i=n("aEodP"),a=n("519R9"),y=n("5FHjI");class l extends r.default{constructor(){if(l.instance)return l.instance;super({shouldIncludeLogs:!0}),l.instance=this}eventHandler=({data:o={}})=>{const{eventName:c}=o;if(this.eventCallbacks[c])for(const p of this.eventCallbacks[c])try{p(o)}catch(u){console.error(u)}};subscribe=(o,c,p={})=>{if((0,y.validateSubscription)({eventName:o,callback:c}))try{super.subscribe({eventName:o,callback:c}),a.default.postMessage({eventName:i.INTERNAL_EVENTS.externalEventSubscribed,subscribedEventName:o,payload:p});const u=new CustomEvent("TOLSTOY_WIDGET_V2_SUBSCRIBE",{detail:{eventName:o,payload:p,callback:c}});window.dispatchEvent(u),console.log("Subscribed to event",o)}catch(u){console.error(u)}};unsubscribe=(o,c)=>super.unsubscribe({eventName:o,callback:c});initInternalMessagingSubscriptions=()=>{a.default.subscribeMultipleEvents({eventNames:e.ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE,callback:this.eventHandler})};init(){this.initInternalMessagingSubscriptions(),this.initListener(this.eventHandler)}}const f=new l;Object.freeze(f);var S=f}),_("kHyIS",function(t,d){s(t.exports,"EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return r}),s(t.exports,"EXTERNAL_EVENTS_TO_POST",function(){return e}),s(t.exports,"ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return i}),s(t.exports,"ALLOWED_EXTERNAL_EVENTS_TO_POST",function(){return a});const r={addToCart:"tolstoy_add_to_cart",spotlightCarouselQuickShopClick:"tolstoy_spotlight_carousel_quick_shop_click",productCardClick:"tolstoy_product_card_click"},e={addToCartSuccess:"tolstoy_add_to_cart_success",addToCartError:"tolstoy_add_to_cart_error",acceptCookiePolicy:"tolstoy_accept_cookie_policy",rejectCookiePolicy:"tolstoy_reject_cookie_policy",tolstoyZIndexChange:"tolstoy_z_index_change",urlLocaleUpdate:"tolstoy_url_locale_update",productUpdate:"tolstoy_product_update"},i=Object.values(r),a=new Set([e.addToCartSuccess,e.addToCartError,e.acceptCookiePolicy,e.rejectCookiePolicy,e.tolstoyZIndexChange,e.urlLocaleUpdate,e.productUpdate])}),_("5FHjI",function(t,d){s(t.exports,"validateSubscription",function(){return e});var r=n("kHyIS");const e=({eventName:i,callback:a})=>{if(!r.ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE.includes(i)){console.error(`Event ${i} is not a valid event`);return}if(!a){console.error("Callback must be provided");return}if(typeof a!="function"){console.error("Callback must be a function");return}return!0}})})();
