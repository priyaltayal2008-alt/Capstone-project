(function(){function q(o){Object.defineProperty(o,"__esModule",{value:!0,configurable:!0})}function S(o,F,m,y){Object.defineProperty(o,F,{get:m,set:y,enumerable:!0,configurable:!0})}var K=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},p=K.parcelRequire94c2,Y=p.register;Y("2LevF",function(o,F){q(o.exports),S(o.exports,"default",function(){return E});var m=p("aEodP"),y=p("8S0po"),A=p("i1NbZ"),R=p("3eWTV"),x=p("aQK74"),I=p("6QfcD"),v=p("5hapA"),u=p("izL3O"),a=p("j2c9o"),h=p("dQiGr"),_=p("8ptJJ"),U=p("kCbDV"),k=p("519R9"),G=p("ljwIw"),V=p("8ZCcc"),W=p("93NPo"),D=p("hZHHs"),l=p("6MJM3"),i=p("2S3LN"),g=p("lsUe5"),t=p("99pD6"),c=p("cUJSR");const T="data-tolstoy-element^",P="bd3161d4-1781-4242-943e-8523aa13dd3b",O=({element:$})=>{if((0,I.getAppKey)()!=="56bfe6cb-0926-420a-ac48-4d36a3a2ea07")return!1;try{const e=document.getElementsByTagName("quick-shop")[0];return e?e.contains($):!1}catch{return!1}};class f{constructor(){this.initialized=!1,this.handlePageView=this.handlePageView.bind(this),this.handleView=this.handleView.bind(this),this.onViewPortChange=this.onViewPortChange.bind(this),this.onVideoEnd=this.onVideoEnd.bind(this),this.stopDynamicVideos=this.stopDynamicVideos.bind(this),this.setIsDynamicVideoRunning=this.setIsDynamicVideoRunning.bind(this),this.handleDynamicVideos=this.handleDynamicVideos.bind(this),this.modalMessageHandler=this.modalMessageHandler.bind(this),this.onScroll=this.onScroll.bind(this),this.scrollToPrevious=this.scrollToPrevious.bind(this),this.scrollToNext=this.scrollToNext.bind(this),this.currentVideoPlaying=0,this.isDynamicVideoRunning=!1,this.dynamicVideoIndex=0,this.isCreateResolutionCalled=!1,this.initInternalMessagingSubscriptions()}onVideoEnd(){this.dynamicVideoIndex=(0,y.getNextNonImageIndex)(this.data.storiesEmbed.storiesSteps,this.dynamicVideoIndex),this.handleDynamicVideos()}onViewPortChange(){(0,i.onViewPortChangeHandler)({videoClass:t.PUBLIC_CLASSES.storyVideo,isDynamicVideoRunning:this.isDynamicVideoRunning,setIsDynamicVideoRunning:this.setIsDynamicVideoRunning,dynamicVideoHandler:this.handleDynamicVideos,publishId:this.data.publishId,onVideoEnd:this.onVideoEnd})}setIsDynamicVideoRunning(e){this.isDynamicVideoRunning=e}stopDynamicVideos(){(0,i.stopDynamicVideos)({videoClass:t.PUBLIC_CLASSES.storyVideo,onVideoEnd:this.onVideoEnd,publishId:this.data.publishId,setIsDynamicVideoRunning:this.setIsDynamicVideoRunning})}start(e){this.modal?.open(e),this.onYouModal?.hide()}getElementByPublicId(e){return window.document.querySelector(`[data-tolstoy-element="${(0,i.getPublicId)(e,this.data.publishId)}"]`)}getAllElements(e,s=window.document){return s.querySelectorAll(e)}getIdWithPrefixSelector(e){return`[${T}=${e}]`}addOnClickEventsToStoryTiles(e){const s=(0,i.getPublicId)(t.PUBLIC_CLASSES.storyTile,this.data.publishId),r=this.getIdWithPrefixSelector(s),n=this.getAllElements(r,e);n.entries().length===0&&(0,W.logDevelopmentError)("No tiles found");for(const[d,b]of n.entries())b.getAttribute("hasClickEvent")||(b?.addEventListener("keypress",C=>{(C.code==="Space"||C.code==="Enter")&&this.start(d)}),b.addEventListener("click",()=>{this.start(d)}),b.setAttribute("hasClickEvent",!0),b.setAttribute("tabindex","0"),b.setAttribute("role","button"),b.setAttribute("aria-label","Story tile"))}addOnClickEventToPlusTile(){const e=this.getElementByPublicId(t.PUBLIC_CLASSES.plusTile);e&&(e.setAttribute("role","button"),e.setAttribute("aria-label","Plus"),e.setAttribute("tabindex","0"),e.addEventListener("click",()=>{this.start(this.numberOfTiles)}))}addOnClickEventToOnYouButton(e){const s=this.getElementByPublicId(e);s&&(s.setAttribute("role","button"),s.setAttribute("aria-label","On You"),e===t.PUBLIC_CLASSES.onlyOnYouButton?s.addEventListener("click",()=>{this.modal?.hide(),this.onYouModalOnly?.open()}):e===t.PUBLIC_CLASSES.onYouButton&&s.addEventListener("click",()=>{this.modal?.hide(),this.onYouModal?.open()}))}getMaxTilesNumber(){const{storiesItemsSizeType:e=t.DEFAULT_STORIES_ITEMS_SIZE_TYPE,storiesItemsPerRow:s=t.DEFAULT_STORIES_ITEMS_PER_ROW,storiesCircleSize:r=t.DEFAULT_STORIES_SIZE,storiesItemsSpacing:n=t.DEFAULT_STORIES_SPACING}=this.data.storiesEmbed;if(e===t.STORIES_ITEMS_SIZE_TYPES.responsive)return s;const d=this.parentWidth-r,b=r+n;return Math.floor(d/b)+1}getCircleSize(e){const{storiesItemsSizeType:s=t.DEFAULT_STORIES_ITEMS_SIZE_TYPE,storiesCircleSize:r=t.DEFAULT_STORIES_SIZE,storiesItemsSpacing:n=t.DEFAULT_STORIES_SPACING}=this.data.storiesEmbed;if(s===t.STORIES_ITEMS_SIZE_TYPES.responsive){const d=this.parentWidth/e-n;return Math.min(d,t.STORIES_ITEM_MAX_FIXED_SIZE)}return r}initTileNumbers(){const{storiesEmbed:e}=this.data,{storiesSteps:s,storiesRectangleWidth:r=t.DEFAULT_STORIES_SIZE,storiesRectangleHeight:n=t.DEFAULT_STORIES_SIZE,storiesItemsShape:d,storiesItemsSizeType:b,storiesStoryNameType:C}=e,B=s.length,L=this.getMaxTilesNumber(),w=this.getCircleSize(L);this.numberOfTiles=Math.min(B,L);const M=d==="circle",N=b===t.STORIES_ITEMS_SIZE_TYPES.responsive,H=C===t.STORIES_NAME_LOCATION.overlay;this.tilesData={numberOfSteps:B,numberOfTiles:this.numberOfTiles,tileSize:w,storiesRectangleWidth:r,storiesRectangleHeight:n,isCircle:M,isResponsive:N,isTextOverlay:H}}addOnErrorEventToImages(){const{publishId:e}=this.data,s=(0,i.getPublicId)(t.PUBLIC_CLASSES.storyImage,e),r=this.getIdWithPrefixSelector(s),n=this.getAllElements(r);for(const d of n)d.addEventListener("error",async()=>{d.src.includes(a.WEBP_AVATAR_EXTENSION)?d.src=d.src.replace(a.WEBP_AVATAR_EXTENSION,a.JPG_AVATAR_EXTENSION):d.src.includes(a.JPG_AVATAR_EXTENSION)&&(d.src=d.src.replace(a.JPG_AVATAR_EXTENSION,a.JPG_EXTENSION)),e&&!this.isCreateResolutionCalled&&(await(0,v.reCreateResolutions)(e),this.isCreateResolutionCalled=!0)})}addOnErrorEventToVideos(){const{publishId:e}=this.data,s=document.querySelectorAll(`.${t.PUBLIC_CLASSES.storyVideo}`);for(const r of s)r.addEventListener("error",async n=>{n.type==="error"&&n.target.error===null&&(r.poster.includes(a.WEBP_AVATAR_EXTENSION)?r.poster=r.poster.replace(a.WEBP_AVATAR_EXTENSION,a.JPG_AVATAR_EXTENSION):r.poster.includes(a.JPG_AVATAR_EXTENSION)&&(r.poster=r.poster.replace(a.JPG_AVATAR_EXTENSION,a.JPG_EXTENSION)),e&&!this.isCreateResolutionCalled&&(await(0,v.reCreateResolutions)(e),this.isCreateResolutionCalled=!0))})}initSkeleton({element:e,data:s}){const n={storiesEmbed:{storiesSteps:[{},{},{},{},{},{}],storiesBorderColor:null,storiesBorderWidth:null,storiesBorder:null,storiesPlayButtonOpacity:.1,storiesBorderRadius:50,storiesTitle:null,skeleton:!0,storiesAlignment:"left",...s,storiesMotion:"static"},featureSettings:{},publishId:"skeleton"};this.data=n;const{parentElement:{clientWidth:d}}=e;this.parentWidth=d,this.initTileNumbers(),e.innerHTML=(0,c.default)(n,d,this.tilesData,t.PUBLIC_CLASSES.onYouButton),this.handleScrollEvents()}async init(e,s,r){this.element=e;const n=(0,i.getEmbedPublishId)(e),d=s&&["string","number"].includes(typeof s)?s:(0,A.getEmbedProductId)(e),b=(0,u.getShop)()||window.Shopify?.shop,C=e.dataset?.tags?.split(",")?.filter(Boolean)||"",B=!n&&!d&&!C?.length;if(window.tolstoyWidget={...window.tolstoyWidget,[n]:{init:(L,w)=>{if(this?.modal?.remove?.(),this.onYouModal?.remove?.(),typeof L=="object"&&L!==null){const{productId:M,tags:N,variantId:H}=L;M!==void 0&&(e.dataset.productId=M),N!==void 0&&(e.dataset.tags=N),this.init(e,M,H||w)}else this.init(e,L,w)}}},window.Shopify?.designMode&&B&&this.initSkeleton({element:e,data:{storiesTitleText:(0,i.getMessageFromError)("Invalid publishId"),storiesTitleEnabled:!0,storiesAlignment:"center"}}),B){this.initialized=!1;return}if(!O({element:e})){window.Shopify?.designMode&&this.initSkeleton({element:e,data:{storiesTitleText:"Loading...",storiesTitleEnabled:!1,storiesAlignment:"center"}});try{const L=await(0,i.getConfig)({publishId:n,productId:d,widgetType:U.STORY_EMBED_WIDGET,tags:C,appUrl:b,variantId:r});if(!L){this.initialized=!1,e.innerHTML="";return}const w=this.initOnYou({data:L,element:e,productId:d});if(L.disabled){this.initialized=!1,e.innerHTML="";return}this.initElements({element:e,data:L,productId:d,isOnYouEnabled:w})}catch(L){throw window.Shopify?.designMode&&L.message&&this.initSkeleton({element:e,data:{storiesTitleText:L.additionalData?.element||L.message,storiesTitleEnabled:!0,storiesAlignment:"center"}}),(0,W.logDevelopmentError)(L),this.initialized=!1,L}}}initOnYou({data:e,element:s,productId:r}){const n=e?.featureSettings?.[h.FEATURE_WIDGET_ONYOU],d=e?.featureSettings?.[h.FEATURE_WIDGET_ONYOU_ALL_PAGES],b=e?.storiesEmbed?.storiesOnYouEnabled??!0,C=(0,W.getSafeParameter)("oyd")==="true",B=C||b&&r&&n;return(C||B&&e.disabled&&d)&&(e.productId=r,e.feedSettings={...e.feedSettings,isFullscreenFeed:!1},this.data=e,this.onYouModalOnly=new D.default({...e,verticalOrientation:!0,productId:r},D.ModalType.ON_YOU),s.innerHTML=(0,c.default)({...e,storiesEmbed:{storiesSteps:[]}},0,{numberOfTiles:0},t.PUBLIC_CLASSES.onlyOnYouButton,B),this.addOnClickEventToOnYouButton(t.PUBLIC_CLASSES.onlyOnYouButton)),B}initSearchBar({data:e,element:s,productId:r}){const n=e?.featureSettings?.[h.FEATURE_STORIES_SEARCH_BAR_CUSTOMIZATION],d=e?.storiesEmbed?.storiesSearchBarEnabled!==!1,b=n&&d&&s;if(!b)return!1;const C=e?.storiesEmbed?.storiesSearchBarPosition||"bottom",{appKey:B}=e,L=(0,u.getShop)()||window.Shopify?.shop||e.appUrl;let w=document.createElement("div");w.innerHTML=`
        <search-bar-widget
      className="search-bar-widget"
      class="search-bar-widget"
      data-widget="search-bar-on-stories"
      data-app-url=${L}
      data-app-key=${B}
      data-product-id=${r}
      style={{
        pointerEvents: 'auto',
        marginRight: '8px',
      }}
    />
    `,w=w.firstElementChild,w.addEventListener("click",N=>{N.stopPropagation()});const M=s.querySelector(`.${t.PUBLIC_CLASSES.titleContainer}`);if(C==="top"?M.parentElement.insertBefore(w,M):M.parentElement.append(w),!document.querySelector("#tolstoy-widget-v2-script")){const N=document.createElement("script");N.type="module",N.async=!0,N.src=`https://play.gotolstoy.com/widget-v2/widget.js?v=${Date.now()}`,N.id="tolstoy-widget-v2-script",N.dataset.shop=L,N.dataset.appKey=B,N.dataset.productGalleryProjects="[]",N.dataset.collectionGalleryProjects="[]",N.dataset.productId=r,N.dataset.collectionId="",N.dataset.widgetType="",document.body.append(N)}return b}initElements({element:e,data:s,productId:r,isOnYouEnabled:n}){try{s.playerType=U.STORY_EMBED_WIDGET,s.productId=r,(0,V.getIsPlayerLazy)(s)&&(s.playerLazy=!0),this.data=s,this.dynamicVideoIndex=(0,y.getNextNonImageIndex)(this.data.storiesEmbed.storiesSteps);const{parentElement:{clientWidth:d}}=e;this.parentWidth=d,this.initTileNumbers(),e.innerHTML=(0,c.default)(s,d,this.tilesData,t.PUBLIC_CLASSES.onYouButton,n),(0,R.injectJsonLdForSteps)({container:e,steps:s?.storiesEmbed?.storiesSteps||[],buildPoster:C=>(0,l.getImageUrlByStep)(C),buildContentUrl:C=>(0,l.getBaseUrl)({step:C,isStory:!0}),publishId:s.publishId,videoId:s?.storiesEmbed?.storiesSteps?.[0]?.videoId}),window.location.origin!==void 0&&(this.modal=new D.default(this.data),n&&r&&(this.onYouModal=new D.default({...this.data,productId:r,feedSettings:{...this.data.feedSettings,isFullscreenFeed:!1}},D.ModalType.ON_YOU))),(0,I.getAppKey)()===P?setTimeout(()=>{this.addOnClickEventsToStoryTiles(),this.addOnClickEventToPlusTile(),this.addOnClickEventToOnYouButton(t.PUBLIC_CLASSES.onYouButton)},3e3):(this.addOnClickEventsToStoryTiles(),this.addOnClickEventToPlusTile(),this.addOnClickEventToOnYouButton(t.PUBLIC_CLASSES.onYouButton)),(0,i.reloadFontIfNeeded)(this.data),this.addOnErrorEventToImages(),this.addOnErrorEventToVideos(),this.handleScrollEvents(),this.handleMotion(this.data),(0,x.setImpressionByPublishId)(s.publishId,!1),this.initSearchBar({data:s,element:e,productId:r}),this.initialized=!0}catch(d){(0,W.logDevelopmentError)(d),this.initialized=!1}}getIsInitialized(){return this.initialized}async refresh(e={}){if(!this.element){console.warn("Story widget: Cannot refresh - element not found");return}const{productId:s,tags:r,variantId:n}=e;s!==void 0&&(this.element.dataset.productId=s),r!==void 0&&(this.element.dataset.tags=r),this.initialized=!1,this.element.innerHTML="",this.modal?.remove?.(),this.onYouModal?.remove?.(),this.onYouModalOnly?.remove?.(),await this.init(this.element,s,n)}handleMotion({storiesEmbed:e}){const{storiesMotion:s}=e;(!s||s===t.EMBED_STORY_MOTION.dynamic)&&this.handleDynamicEvents()}getEventParams(){return{currentPageProductId:this.data.productId}}handlePageView(){this.data.playerLazy&&this.modal.sendPageView(this.getEventParams())}handleView(){(0,x.setImpressionByPublishId)(this.data.publishId,!0),this.modal.sendEmbedView(this.getEventParams())}handleOpenEvent(e){e.eventData?.stopDynamicEmbed&&this.stopDynamicVideos()}modalMessageHandler({data:e}){if(e.name!==_.WIDGETS_MESSAGES)return;const r={[_.WIDGET_MESSAGES_EVENTS.OPEN]:n=>this.handleOpenEvent(n),[_.WIDGET_MESSAGES_EVENTS.CLOSE]:n=>this.onViewPortChange(n)}[e.type];r?.(e)}handleDynamicEvents(){this.onViewPortChange(),window.addEventListener("load",this.onViewPortChange),window.addEventListener("scroll",this.onViewPortChange),window.addEventListener("message",this.modalMessageHandler)}onScroll(e){const s=e.target,r=s.scrollLeft,d=s.scrollWidth-s.clientWidth-1;r?this.getElementByPublicId(t.PUBLIC_CLASSES.previousButton).dataset.visibility=g.STORIES_ARROWS_VISIBILITY_ATTRIBUTES.visible:this.getElementByPublicId(t.PUBLIC_CLASSES.previousButton).dataset.visibility=g.STORIES_ARROWS_VISIBILITY_ATTRIBUTES.hidden,d<=r?this.getElementByPublicId(t.PUBLIC_CLASSES.nextButton).dataset.visibility=g.STORIES_ARROWS_VISIBILITY_ATTRIBUTES.hidden:this.getElementByPublicId(t.PUBLIC_CLASSES.nextButton).dataset.visibility=g.STORIES_ARROWS_VISIBILITY_ATTRIBUTES.visible}scrollToNext(){const e=this.getElementByPublicId(t.PUBLIC_CLASSES.tilesContainer),s=e.scrollLeft,r=e.scrollWidth-e.clientWidth;let n=s+e.clientWidth;s===r&&(n=0),n>r&&(n=r),e.scroll({left:n,behavior:"smooth",block:"nearest"})}scrollToPrevious(){const e=this.getElementByPublicId(t.PUBLIC_CLASSES.tilesContainer),s=e.scrollLeft,r=e.scrollWidth-e.clientWidth;let n=s-e.clientWidth;s||(n=r),n<0&&(n=0),e.scroll({left:n,block:"nearest",behavior:"smooth"})}handleScrollEvents(){const e=this.getElementByPublicId(t.PUBLIC_CLASSES.tilesContainer);if(!e)return;const s=this.getElementByPublicId(t.PUBLIC_CLASSES.nextButton),r=this.getElementByPublicId(t.PUBLIC_CLASSES.previousButton);if(e.scrollWidth-e.clientWidth<=1){s.style.display="none",r.style.display="none";return}r.addEventListener("click",this.scrollToPrevious),s.addEventListener("click",this.scrollToNext),e.addEventListener("scroll",this.onScroll)}handleDynamicVideos(){const e=this.dynamicVideoIndex,s=(0,i.getAllElements)(t.PUBLIC_CLASSES.storyVideo,this.data.publishId),r=s[e];if(!s?.length)return;const{scrollActiveStoryIntoView:n}=(0,V.getFeatureSettings)({config:this.data,key:h.FEATURE_WIDGET_LOADING})||{};n&&r?.scrollIntoViewIfNeeded?.();const d=b=>{if(b.name!==U.DOM_EXCEPTION_ERRORS.abortError){if(b.name!==U.DOM_EXCEPTION_ERRORS.notAllowedError)throw b;e===0&&(0,W.getIsIOS)()&&this.modal.loadFullPlayer()}};if(!r){this.dynamicVideoIndex=0,this.handleDynamicVideos();return}if(!r.src){const b=this.data.storiesEmbed.storiesSteps[e];if(r.src=(0,l.getBaseUrl)({step:b,isStory:!0}),(0,W.getIsIOS)()){try{r.autoplay="true"}catch(C){d(C)}r.addEventListener("ended",this.onVideoEnd,{once:!0});return}r.addEventListener("canplay",()=>{(0,G.safePlayVideo)({video:r,onError:d})},{once:!0})}(0,G.safePlayVideo)({video:r,onError:d}),r.addEventListener("ended",this.onVideoEnd,{once:!0})}removeWindowEventListeners=()=>{window.removeEventListener("load",this.onViewPortChange),window.removeEventListener("scroll",this.onViewPortChange),window.removeEventListener("message",this.modalMessageHandler)};internalMessagingHandler=({data:e})=>{switch(e.eventName){case m.INTERNAL_EVENTS.urlChange:this.removeWindowEventListeners();break;default:return null}};initInternalMessagingSubscriptions(){k.default.subscribeMultipleEvents({eventNames:g.INTERNAL_MESSAGES_TO_SUBSCRIBE,callback:this.internalMessagingHandler})}}var E=f}),Y("8S0po",function(o,F){S(o.exports,"isImageAsset",function(){return A}),S(o.exports,"isGalleryAsset",function(){return R}),S(o.exports,"getStepImageUrl",function(){return I}),S(o.exports,"getNextNonImageIndex",function(){return v});var m=p("kq83N"),y=p("e8kzi");const A=u=>u?.type===m.ASSET_TYPE.IMAGE,R=u=>u?.type===m.ASSET_TYPE.GALLERY,x=u=>!u?.type||u?.type===m.ASSET_TYPE.VIDEO,I=({videoOwner:u,videoId:a},{size:h=m.IMAGE_SIZE.M}={})=>(0,y.buildUrl)({ownerId:u,assetId:a,suffix:m.IMAGE_SIZE_SUFFIX[h],extension:m.DEFAULT_IMAGE_EXTENSION}),v=(u,a=-1)=>{for(let h=a+1;h<u.length;h++)if(!A(u[h]))return h}}),Y("3eWTV",function(o,F){S(o.exports,"buildVideoObject",function(){return _}),S(o.exports,"buildItemListObject",function(){return k}),S(o.exports,"buildJsonLdScriptMarkup",function(){return G}),S(o.exports,"upsertJsonLdScript",function(){return V}),S(o.exports,"injectJsonLdForSingleVideo",function(){return W}),S(o.exports,"injectJsonLdForSteps",function(){return D});var m=p("5GYRu"),y=p("93NPo");const A=l=>{if(!(!l&&l!==0)){if(typeof l=="string"){const i=l.trim();if(/^pt/i.test(i))return i;const g=i.match(/^(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?$/);if(g){const c=Number(g[3]?g[1]:0),T=Number(g[3]?g[2]:g[1]),P=Number(g[3]?g[3]:g[2]),O=[];return c&&O.push(`${c}H`),T&&O.push(`${T}M`),O.push(`${P||0}S`),`PT${O.join("")}`}const t=Number.parseFloat(i);Number.isFinite(t)&&(l=t)}if(typeof l=="number"&&Number.isFinite(l)){const i=Math.max(0,Math.floor(l)),g=Math.floor(i/3600),t=Math.floor(i%3600/60),c=i%60,T=[];return g&&T.push(`${g}H`),t&&T.push(`${t}M`),T.push(`${c}S`),`PT${T.join("")}`}}},R=l=>{try{if(!l)return"";const i=`${l}`.trim();return/^https?:\/\//i.test(i)?i:new URL(i,document.baseURI).href}catch{return""}},x=(l,i)=>{if(!l)return"";const g=l.trim();if(g.length<=i)return g;const t=g.slice(0,i-1),c=t.lastIndexOf(" ");return c>i*.8?t.slice(0,c)+"\u2026":t+"\u2026"},I=()=>{try{const l=document?.querySelector?.('meta[property="og:site_name"]')?.content;if(l)return l;const i=document?.querySelector?.('meta[name="application-name"]')?.content;if(i)return i;const g=document?.querySelector?.('meta[itemprop="name"]')?.content;if(g)return g;const t=document?.title;return t||window?.location?.hostname||""}catch{return""}},v=()=>{try{const l=document?.querySelector?.('link[rel="apple-touch-icon"]')||document?.querySelector?.('link[rel*="icon"]'),i=l?.href||l?.getAttribute?.("href"),g=l?.getAttribute?.("sizes")||"";let t,c;const T=g?.match?.(/(\d+)\s*x\s*(\d+)/i);T&&(t=Number(T[1]),c=Number(T[2]));const P=R(i||"");return P?{"@type":"ImageObject",url:P,...t?{width:t}:{},...c?{height:c}:{}}:null}catch{return null}},u=()=>{try{const l=I(),i=v();return l?{"@type":"Organization",name:l,...i?{logo:i}:{}}:null}catch{return null}},a=({publishId:l,videoId:i})=>{try{const g=new URL(window.location.href),t=g.searchParams;return l&&t.set("tolstoyAutoOpen",`${l}`),t.set("utm_source","tolstoy"),t.set("utm_medium","feed_share"),i&&t.set("tolstoy-start-video",`${i}`),g.search=t.toString(),g.toString()}catch{return window.location.href}},h=u(),_=({partName:l,poster:i,duration:g,uploadDate:t,contentUrl:c,publishId:T,videoId:P})=>{const O=R(i),f=R(c),E=(0,y.removeHtmlTags)(l||""),$=x(E,100);if(!O||!f||!t||!$)return null;const e=x(E,300),s=A(g);return{"@context":"https://schema.org","@type":"VideoObject",name:$,description:e,thumbnailUrl:O,...s?{duration:s}:{},uploadDate:t,contentUrl:f,...h?{publisher:h}:{},url:a({publishId:T,videoId:P})}},U=({product:l,variantId:i})=>{if(!l)return null;const g=l?.variants?.find?.(E=>`${E?.id}`==`${i}`)||l?.variants?.[0],t=(0,m.getPDPUrl)(l,i)||"",c=g?.price??l?.price,T=l?.currencyCode||"",P=l?.title||"",O=R(l?.imageUrl||"");if(!P||!O||!T||!c&&c!==0||!t)return null;const f=g?.isVariantAvailableForSale===!1?"https://schema.org/OutOfStock":"https://schema.org/InStock";return{"@context":"https://schema.org","@type":"Product",name:x(P,150),image:O,sku:`${g?.id||""}`,offers:{"@type":"Offer",priceCurrency:T,price:c,availability:f,url:t}}},k=l=>{const i=l||[];return i.length===0?null:{"@context":"https://schema.org","@type":"ItemList",itemListElement:i.map((t,c)=>{const T=t?.partName||t?.videoName||t?.name||`Video ${c+1}`;return{"@type":"ListItem",position:c+1,url:window.location.href,name:x(T,100)}}),numberOfItems:i.length,itemListOrder:"https://schema.org/ItemListOrderAscending"}},G=(l,i)=>i?`<script type="application/ld+json" data-tolstoy-schema="${l}">${JSON.stringify(i)}<\/script>`:"",V=(l,i,g)=>{const t=l?.querySelector?.(`script[data-tolstoy-schema="${i}"]`);if(!g){t&&t.parentElement&&t.remove();return}const c=t||document.createElement("script");c.type="application/ld+json",c.dataset.tolstoySchema=i,c.textContent=JSON.stringify(g),t||l?.appendChild?.(c)},W=({container:l,step:i,poster:g,contentUrl:t,product:c,variantId:T,publishId:P})=>{try{const O=i?.type==="image",f=O?null:_({partName:i?.partName||i?.videoName,poster:g,duration:i?.duration,uploadDate:i?.createdAt,contentUrl:t,publishId:P,videoId:i?.videoId});V(l,"video",f);const E=!O&&c?U({product:c,variantId:T}):null;V(l,"product",E)}catch{}},D=({container:l,steps:i,buildPoster:g,buildContentUrl:t,publishId:c})=>{try{const T=k(i||[]);V(l,"itemlist",T),(i||[]).forEach((P,O)=>{if(P?.type==="image")return;const f=g(P),E=t(P),$=_({partName:P?.partName||P?.videoName,poster:f,duration:P?.duration,uploadDate:P?.createdAt,contentUrl:E,publishId:c,videoId:P?.videoId});V(l,`video-${O}`,$)})}catch{}}}),Y("5GYRu",function(o,F){S(o.exports,"getPDPUrl",function(){return u});var m=p("lUrCX"),y=p("k3iEx");const A=/\/([a-z]{2}-[a-z]{2})(\/|$)/i,R=()=>{if(window.Shopify?.routes?.root)return window.Shopify.routes.root;const h=window.location.pathname.match(A);return h?`/${h[1]}/`:"/"},x=(a,h)=>{const _=a.match(A);return _?a.replace(_[0],h):a},I=()=>{const a=document.querySelectorAll("script");for(const _ of a){const U=_.src;if(_.innerHTML.includes("shopify")||U.includes("shopify"))return!0}const h=document.querySelectorAll("link");for(const _ of h){const U=_.href;if(_.innerHTML.includes("shopify")||U.includes("shopify"))return!0}return!1},v=(a,h)=>{if(!h)return a;const _=a.includes("?")?"&":"?";return`${a}${_}variant=${h}`},u=({appUrl:a=window.location?.host,handle:h},_)=>{if((0,m.isUrl)(h)){const W=window.location.pathname.match(A);if(W){const D=`/${W[1]}/`,l=x(h,D);return v(l,_)}return v(h,_)}const U=R();let k=a;window?.location?.host&&a!==window.location.host&&(k=(0,y.isShopifyStore)()||I()?window.location.host:a);const G=`https://${k}${U}products/${h}`;return v(G,_)}}),Y("5hapA",function(o,F){S(o.exports,"reCreateResolutions",function(){return R});var m=p("eSOI5"),y=p("kK0IS");const A=!1,R=async x=>{A&&((0,m.getTolstoyRecreateResolution)(x)||(await(0,y.createResolutions)(x),(0,m.setTolstoyRecreateResolution)(x)))}}),Y("lsUe5",function(o,F){S(o.exports,"STORIES_ARROWS_VISIBILITY_ATTRIBUTES",function(){return y}),S(o.exports,"INTERNAL_MESSAGES_TO_SUBSCRIBE",function(){return A});var m=p("aEodP");const y={visible:"visible",hidden:"hidden"},A=[m.INTERNAL_EVENTS.urlChange]}),Y("cUJSR",function(o,F){S(o.exports,"default",function(){return g});var m=p("e857j"),y=p("8S0po"),A=p("e8kzi"),R=p("kq83N"),x=p("2S3LN"),I=p("j2c9o"),v=p("3nE5E"),u=p("32Pbn"),a=p("99pD6"),h=p("2GdFQ");let _=!1;const U=t=>{_&&(t.style.fontFamily=`'tolstoy-custom-font-family', ${m.FALLBACK_FONTS}`)},k=({avatarUrl:t,posterUrl:c})=>t||(v.VIDEO_PROVIDERS.some(T=>c.includes(T))?c:c.replace(a.POSTER_SUFFIX,a.STORIES_IMAGE_EXTENSION)),G=({posterUrl:t,avatarUrl:c,extension:T,isDuplicated:P})=>t?.endsWith(T)||c?.endsWith(T)||P,V=({storiesTitleEnabled:t,storiesTitleText:c,storiesTitleFontSize:T,storiesMobileTitleFontSize:P,storiesTitleFontWeight:O,storiesTitleColor:f,storiesAlignment:E},$)=>{if(!t||!c)return"";const e=typeof c=="string"?c:c.textContent,s=window.innerWidth<450?P:T,r=document.createElement("div");return r.classList.add(a.PUBLIC_CLASSES.titleContainer),r.tolstoyElement=(0,x.getPublicId)(a.PUBLIC_CLASSES.titleContainer,$),r.style.textAlign=E,r.style.fontSize=`${s}px`,r.style.fontWeight=O,r.style.color=f,r.setAttribute("role","heading"),r.setAttribute("aria-level","2"),r.setAttribute("aria-label",`Tolstoy stories title: ${e.replace(/\s+/g," ")}`),r.append(c),U(r),r.outerHTML},W=({storyNameCss:t,partName:c,key:T,publishId:P,isTextOverlay:O,storiesEmbed:{storiesBorderRadius:f,storiesStoryNameTextAlign:E,storiesStoryNameAlignment:$,storiesStoryNamePadding:e,storiesStoryNameFontWeight:s},storiesCircleSize:r})=>{const n=document.createElement("div"),d=document.createElement("div");n.classList.add(u.storyName,a.PUBLIC_CLASSES.tileName),n.dataset.tolstoyElement=`${(0,x.getPublicId)(a.PUBLIC_CLASSES.storyName,P)}_${T}`,d.style=t,d.style.fontWeight=s,d.setAttribute("aria-label",c),d.append(c),U(n),O&&(n.classList.add(u.textOverlayContainer),d.classList.add(u.textOverlay),n.style.textAlign=E,n.style.justifyContent=E,n.style.alignItems=$,n.style.padding=`${e??"8px"}`);const b=f*(r/a.DEFAULT_STORIES_SIZE);return O&&(n.style.borderRadius=`${b}px`),n.append(d),n.outerHTML},D=(t,c,T,P)=>{let O="";const f=[...t.storiesSteps],{skeleton:E,storiesMotion:$}=t,{tileSize:e=a.DEFAULT_STORIES_SIZE,storiesRectangleWidth:s,storiesRectangleHeight:r,isCircle:n,isResponsive:d,isTextOverlay:b}=T,C=(0,h.getBorderCss)(t,T),B=(0,h.getStoryNameCss)(t),L=P?.["widget-poster-settings"];let w=0;for(const M of f){const{partName:N,key:H}=M,j=(0,y.isImageAsset)(M),J=j?"":(0,x.getVideoBaseUrl)({step:M,embedMotion:a.EMBED_STORY_MOTION.dynamic,isStory:!0}),X=j?(0,y.getStepImageUrl)(M,{size:R.IMAGE_SIZE.XS}):(0,A.getImageUrl)({step:M,extension:e>=a.STORIES_HIGHER_IMAGE_RESOLUTION_SIZE?I.WEBP_EXTENSION:I.WEBP_AVATAR_EXTENSION,posterSettings:L,size:e>=a.STORIES_HIGHER_IMAGE_RESOLUTION_SIZE?R.IMAGE_DIMENSIONS["480x480"]:R.IMAGE_DIMENSIONS["250x250"],custom:{condition:G,callback:k}}),z=(0,h.getVideoHtml)({videoUrl:J,posterUrl:X,key:H,borderCss:C,publishId:c,storiesCircleSize:e,partName:N,storiesRectangleWidth:s,storiesRectangleHeight:r,isCircle:n,isResponsive:d,step:M}),Z=(0,h.getImageHtml)({imageUrl:X,key:H,borderCss:C,publishId:c,storiesCircleSize:e,partName:N,stepIndex:w,storiesRectangleWidth:s,storiesRectangleHeight:r,isCircle:n,isResponsive:d}),Q=W({partName:N,key:H,storyNameCss:B,publishId:c,isTextOverlay:b,storiesEmbed:t,storiesCircleSize:e});O+=(0,h.getTile)({imageHtml:Z,storyNameHtml:Q,publishId:c,key:H,skeleton:E,videoHtml:z,storiesMotion:$,storiesCircleSize:e,partName:N,storiesRectangleWidth:s,storiesRectangleHeight:r,isCircle:n,isResponsive:d,storiesEmbed:t}),w++}return O},l=({storiesAlignment:t},c,T)=>`
    <a
      style="
        text-align: ${t||"left"};
        text-decoration: underline;
        cursor: pointer;
      "
      data-tolstoy-element="${(0,x.getPublicId)(T,c)}"
      aria-label="See it on you"
    >
      See it on you
    </a>
  `;var g=({storiesEmbed:t,publishId:c,design:T,featureSettings:P},O,f,E,$=!1)=>{_=!!T?.branding?.typography?.font?.family;const e=V(t,c),s=D(t,c,f,P),r=(0,h.getTilesAlignmentCss)(t),n=(0,h.getTilesContainerCss)(t,f,O);return` 
    <div v-pre class="${a.PUBLIC_CLASSES.storiesMainContainer} ${u.stories}">
			${e}
      <div
        class="${u.storiesContainer} ${a.PUBLIC_CLASSES.storiesContainer}"
        style="${r}"
        data-tolstoy-element="${(0,x.getPublicId)(a.PUBLIC_CLASSES.storiesContainer,c)}"
      >
        <div class="${u.storiesVideoContainer}">
          ${(0,h.getPreviousButton)(c)}
          <div
            class="${u.tilesContainer} ${a.PUBLIC_CLASSES.tilesContainer}"
            style="${n}"
            data-tolstoy-element="${(0,x.getPublicId)(a.PUBLIC_CLASSES.tilesContainer,c)}"
            aria-label="Tolstoy Stories"
            role="group"
          >
            ${s}
          </div>
          ${(0,h.getNextButton)(c)}
        </div>
      </div>
      ${$?l(t,c,E):""}
		</div>
	`}}),Y("3nE5E",function(o,F){S(o.exports,"VIDEO_PROVIDERS",function(){return A});const A=["synthesia","vimeo"]}),Y("32Pbn",function(o,F){S(o.exports,"arrowButtonContainer",function(){return m},function(i){return m=i}),S(o.exports,"nextArrowButtonContainer",function(){return y},function(i){return y=i}),S(o.exports,"playButtonContainer",function(){return A},function(i){return A=i}),S(o.exports,"playButtonContainerStatic",function(){return R},function(i){return R=i}),S(o.exports,"skeleton",function(){return x},function(i){return x=i}),S(o.exports,"skeletonContent",function(){return I},function(i){return I=i}),S(o.exports,"stories",function(){return v},function(i){return v=i}),S(o.exports,"storiesContainer",function(){return u},function(i){return u=i}),S(o.exports,"storiesVideoContainer",function(){return a},function(i){return a=i}),S(o.exports,"storyImage",function(){return h},function(i){return h=i}),S(o.exports,"storyName",function(){return _},function(i){return _=i}),S(o.exports,"storySkeletonTile",function(){return U},function(i){return U=i}),S(o.exports,"storyTile",function(){return k},function(i){return k=i}),S(o.exports,"storyVideo",function(){return G},function(i){return G=i}),S(o.exports,"storyVideoImage",function(){return V},function(i){return V=i}),S(o.exports,"textOverlay",function(){return W},function(i){return W=i}),S(o.exports,"textOverlayContainer",function(){return D},function(i){return D=i}),S(o.exports,"tilesContainer",function(){return l},function(i){return l=i});var m,y,A,R,x,I,v,u,a,h,_,U,k,G,V,W,D,l;m="xh1ArW_arrowButtonContainer",y="xh1ArW_nextArrowButtonContainer",A="xh1ArW_playButtonContainer",R="xh1ArW_playButtonContainerStatic",x="xh1ArW_skeleton",I="xh1ArW_skeletonContent",v="xh1ArW_stories",u="xh1ArW_storiesContainer",a="xh1ArW_storiesVideoContainer",h="xh1ArW_storyImage",_="xh1ArW_storyName",U="xh1ArW_storySkeletonTile",k="xh1ArW_storyTile",G="xh1ArW_storyVideo",V="xh1ArW_storyVideoImage",W="xh1ArW_textOverlay",D="xh1ArW_textOverlayContainer",l="xh1ArW_tilesContainer"}),Y("2GdFQ",function(o,F){S(o.exports,"getBorderCss",function(){return h}),S(o.exports,"getStoryNameCss",function(){return _}),S(o.exports,"getTilesAlignmentCss",function(){return k}),S(o.exports,"getTilesContainerCss",function(){return V}),S(o.exports,"getImageHtml",function(){return W}),S(o.exports,"getVideoHtml",function(){return l}),S(o.exports,"getPreviousButton",function(){return t}),S(o.exports,"getNextButton",function(){return c}),S(o.exports,"getTile",function(){return O});var m=p("j2c9o"),y=p("6QfcD"),A=p("e7ceA"),R=p("68VIL"),x=p("ljwIw"),I=p("2S3LN"),v=p("32Pbn"),u=p("99pD6");const a="56bfe6cb-0926-420a-ac48-4d36a3a2ea07",h=({storiesBorderRadius:f,storiesBorderEnabled:E,storiesBorderWidth:$,storiesBorderColor:e,storiesBorderType:s,storiesBorderOpacity:r},{tileSize:n=u.DEFAULT_STORIES_SIZE})=>{const b=`border-radius: ${f*(n/u.DEFAULT_STORIES_SIZE)}px;`;if(!E)return b;const C=(0,A.getHexOpacity)(e,r);return`
		${b}
		border: ${$}px ${s} ${C};
    padding: 2px;
	`},_=({storiesStoryNameEnabled:f,storiesStoryNameFontSize:E,storiesStoryNameColor:$})=>f?`
		font-size: ${E}px;
		color: ${$};
	`:"display: none;",U=({storiesRectangleWidth:f,storiesRectangleHeight:E,isCircle:$,isResponsive:e})=>$?"1":e?"9/16":`${f}/${E}`,k=({storiesAlignment:f})=>{switch(f){case"left":return"justify-content: flex-start; justify-items: flex-start";case"right":return"justify-content: flex-end; justify-items: flex-end";case"center":return"justify-content: center; justify-items: center";default:return"justify-content: flex-start; justify-items: flex-start;"}},G=({storiesItemsSizeType:f,storiesItemsSpacing:E},{numberOfTiles:$,tileSize:e},s)=>{if(!f)return 8;if(f===u.STORIES_ITEMS_SIZE_TYPES.fixed)return E;const r=$*e,n=($-1)*E;return r+n<=s?E:s/$-e},V=(f,E,$)=>`gap: ${G(f,E,$)}px;`,W=({imageUrl:f,key:E,borderCss:$,publishId:e,storiesCircleSize:s,partName:r,stepIndex:n,storiesRectangleWidth:d,storiesRectangleHeight:b,isCircle:C,isResponsive:B})=>{const L=[v.storyImage,u.PUBLIC_CLASSES.storyImage],{width:w,height:M}=i({isCircle:C,isResponsive:B,storiesCircleSize:s,storiesRectangleWidth:d,storiesRectangleHeight:b}),N={alt:r||`Story video ${n+1} preview`,"aria-label":`Tolstoy story preview: ${r}`,"data-tolstoy-element":`${(0,I.getPublicId)(u.PUBLIC_CLASSES.storyImage,e)}_${E}`,loading:"lazy",width:String(w),height:String(M)},H=D({storiesCircleSize:s,isCircle:C,isResponsive:B,storiesRectangleWidth:d,storiesRectangleHeight:b});function j(X){const z=X.currentTarget;z.src.includes(m.WEBP_AVATAR_EXTENSION)?z.src=z.src.replace(m.WEBP_AVATAR_EXTENSION,m.JPG_AVATAR_EXTENSION):z.src.includes(m.JPG_AVATAR_EXTENSION)&&(z.src=z.src.replace(m.JPG_AVATAR_EXTENSION,m.JPG_EXTENSION))}return(0,x.createElement)({tagName:"img",classNames:L,attributes:N,styleString:$,style:H,src:f,eventListeners:{error:j}}).outerHTML},D=({storiesCircleSize:f,isCircle:E,isResponsive:$,storiesRectangleWidth:e,storiesRectangleHeight:s})=>E?{height:`${f}px`,width:`${f}px`}:$?{"aspect-ratio":"9/16",height:"100%"}:{width:`${e}px`,height:`${s}px`,"aspect-ratio":`${e}/${s}`},l=({videoUrl:f,posterUrl:E,borderCss:$,publishId:e,storiesCircleSize:s,partName:r,isCircle:n,isResponsive:d,storiesRectangleWidth:b,storiesRectangleHeight:C})=>{const B=[v.storyVideo,u.PUBLIC_CLASSES.storyVideo],L={playsinline:"",muted:"","aria-hidden":!0,poster:E,"aria-label":`Tolstoy story video: ${r}`,"data-tolstoy-element":(0,I.getPublicId)(u.PUBLIC_CLASSES.storyVideo,e)},w=D({storiesCircleSize:s,isCircle:n,isResponsive:d,storiesRectangleWidth:b,storiesRectangleHeight:C});return(0,x.createElement)({tagName:"video",src:f,classNames:B,attributes:L,styleString:$,style:w}).outerHTML},i=({isCircle:f,isResponsive:E,storiesCircleSize:$,storiesRectangleWidth:e,storiesRectangleHeight:s})=>f?E?{width:1,height:1}:{width:$,height:$}:E?{width:9,height:16}:{width:e,height:s},g=({storiesEmbed:f,publishId:E,className:$=""})=>{const{storiesPlayButtonSizePercent:e,storiesPlayButtonColor:s,storiesPlayButtonOpacity:r,storiesPlayButtonBackground:n,storiesPlayButtonBackgroundColor:d,storiesPlayButtonBorder:b,storiesPlayButtonBorderColor:C}=f,B=`
    width: ${e}%;
    opacity: ${r};
    background: ${n?d:"transparent"};
    border: ${b?2:0}px solid ${C};
  `,L=(0,R.getPlayButtonSvg)(s);return`
    <div
      role="button"
      aria-label="Open Tolstoy widget"
      class="${v.playButtonContainer} ${u.PUBLIC_CLASSES.playButtonContainer} ${$}"
      data-tolstoy-element="${(0,I.getPublicId)(u.PUBLIC_CLASSES.playButtonContainer,E)}"
      style="${B}"
    >
      ${L}
    </div>
  `},t=f=>`<button
    class="${v.arrowButtonContainer} ${u.PUBLIC_CLASSES.previousButton}"
    data-tolstoy-element="${(0,I.getPublicId)(u.PUBLIC_CLASSES.previousButton,f)}"
    data-visibility="hidden"
    aria-label="Tolstoy stories: previous button"
    type="button"
    style="left: 0;${(0,y.getAppKey)()===a?"display: flex !important;":""}"
  >
    ${R.leftArrowSvg}
  </button>`,c=f=>`<button
    class="${`${v.arrowButtonContainer} ${v.nextArrowButtonContainer} ${u.PUBLIC_CLASSES.nextButton}`}"
    data-tolstoy-element="${(0,I.getPublicId)(u.PUBLIC_CLASSES.nextButton,f)}"
    aria-label="Tolstoy stories: next button"
    type="button"
    style="right: 0;${(0,y.getAppKey)()===a?"display: flex !important;":""}"
  >
    ${R.leftArrowSvg}
</button>`,T=({storyNameHtml:f,publishId:E,key:$,videoHtml:e,maxWidth:s,storiesRectangleWidth:r,storiesRectangleHeight:n,isCircle:d,isResponsive:b,storiesEmbed:C})=>{const B=[v.storyTile,u.PUBLIC_CLASSES.storyTile],L={tabindex:0,"data-tolstoy-element":`${(0,I.getPublicId)(u.PUBLIC_CLASSES.storyTile,E)}_${$}`},w={"max-width":s,"aspect-ratio":U({isCircle:d,isResponsive:b,storiesRectangleWidth:r,storiesRectangleHeight:n})},M={"max-width":s},N=(0,x.createElement)({tagName:"div",classNames:B,attributes:L,style:M}),H=(0,x.createElement)({tagName:"div",classNames:[v.storyVideoImage],style:w});H.innerHTML=e;const j=(0,x.createElement)({tagName:"div",classNames:[v.storyVideo],styleString:"background:transparent;display:flex;width:100%;height:100%;",style:w}),J=e&&C.storiesPlayButtonEnabled?g({storiesEmbed:C,publishId:E}):"";return N.innerHTML=H.outerHTML+J+f+j.outerHTML,N.outerHTML},P=(f,E,$,e)=>!e&&!f?$:E,O=({imageHtml:f,storyNameHtml:E,publishId:$,key:e,skeleton:s,videoHtml:r,storiesMotion:n,storiesCircleSize:d,partName:b,storiesRectangleWidth:C,storiesRectangleHeight:B,isCircle:L,isResponsive:w,storiesEmbed:M})=>{const N=`${b||"Story video"}`,H=`${P(L,d,C,w)}px`;if(s)return`
		<div class="${v.storyTile} ${u.PUBLIC_CLASSES.storyTile} ${v.storySkeletonTile}"
			data-tolstoy-element="${(0,I.getPublicId)(u.PUBLIC_CLASSES.storyTile,$)}_${e}"
			style="max-width: ${H};"
		aria-label="Tolstoy stories skeleton"
		>
		<div class="${v.skeletonContent}"></div>
		</div>
	`;if(!n||n===u.EMBED_STORY_MOTION.dynamic)return T({storyNameHtml:E,publishId:$,key:e,videoHtml:r,storiesCircleSize:d,ariaLabel:N,maxWidth:H,storiesRectangleWidth:C,storiesRectangleHeight:B,isCircle:L,isResponsive:w,storiesEmbed:M});const j=[v.storyTile,u.PUBLIC_CLASSES.storyTile],J={tabindex:0,"data-tolstoy-element":`${(0,I.getPublicId)(u.PUBLIC_CLASSES.storyTile,$)}_${e}`},X={"max-width":`${H}`,"aspect-ratio":U({isCircle:L,isResponsive:w,storiesRectangleWidth:C,storiesRectangleHeight:B})},z=(0,x.createElement)({tagName:"div",classNames:j,attributes:J,style:X}),Z=r&&M.storiesPlayButtonEnabled?g({storiesEmbed:M,publishId:$,className:v.playButtonContainerStatic}):"";return z.innerHTML=f+Z+E,z.outerHTML}}),Y("e7ceA",function(o,F){S(o.exports,"getHexOpacity",function(){return y});const m=A=>A?Math.round(A*255).toString(16).toUpperCase().padStart(2,"0"):"",y=(A,R)=>`${A}${m(R)}`}),Y("kHyIS",function(o,F){S(o.exports,"EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return m}),S(o.exports,"EXTERNAL_EVENTS_TO_POST",function(){return y}),S(o.exports,"ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return A}),S(o.exports,"ALLOWED_EXTERNAL_EVENTS_TO_POST",function(){return R});const m={addToCart:"tolstoy_add_to_cart",spotlightCarouselQuickShopClick:"tolstoy_spotlight_carousel_quick_shop_click",productCardClick:"tolstoy_product_card_click"},y={addToCartSuccess:"tolstoy_add_to_cart_success",addToCartError:"tolstoy_add_to_cart_error",acceptCookiePolicy:"tolstoy_accept_cookie_policy",rejectCookiePolicy:"tolstoy_reject_cookie_policy",tolstoyZIndexChange:"tolstoy_z_index_change",urlLocaleUpdate:"tolstoy_url_locale_update",productUpdate:"tolstoy_product_update"},A=Object.values(m),R=new Set([y.addToCartSuccess,y.addToCartError,y.acceptCookiePolicy,y.rejectCookiePolicy,y.tolstoyZIndexChange,y.urlLocaleUpdate,y.productUpdate])}),Y("5GBWD",function(o,F){S(o.exports,"default",function(){return R});var m=p("aEodP"),y=p("8ptJJ");class A{constructor(I){this.tolstoyIframe=I,this.rechargeMessagingHandler=this.rechargeMessagingHandler.bind(this),this.playerReady=!1,this.playerReadyMessages=[],this.subscribeForPlayerStart(),this.init()}subscribeForPlayerStart(){window.addEventListener("message",I=>{if(I.data&&I.data.eventName===y.TOLSTOY_PLAYER_READY_MESSAGE){this.playerReady=!0;for(const v of this.playerReadyMessages||[])this.tolstoyIframe?.contentWindow?.postMessage(v,"*");this.playerReadyMessages=[]}})}safePostMessageToWindow(I){if(!this.playerReady)return this.playerReadyMessages.push(I);this.tolstoyIframe?.contentWindow.postMessage(I,"*")}async getRechargeWidgetData(){if(!window.ReChargeWidget)return;const I=await window.ReChargeWidget.api.fetchWidgetData();this.safePostMessageToWindow({eventName:y.RECHARGE_WIDGET_DATA_MESSAGE,rechargeWidgetData:I})}async rechargeAddToCart({rechargeCartItem:I,variantId:v}){if(window.ReChargeWidget)try{await window.ReChargeWidget.api.postToCart(I),this.safePostMessageToWindow({eventName:m.INTERNAL_EVENTS.addToCartSuccess,variantId:v})}catch{this.safePostMessageToWindow({eventName:m.INTERNAL_EVENTS.addToCartError,error:"Error adding to cart",variantId:v})}}rechargeMessagingHandler(I){if(I.data.name===y.RECHARGE_MESSAGING)switch(I.data.type){case y.REQUEST_RECHARGE_WIDGET_DATA_MESSAGE:return this.getRechargeWidgetData();case y.REQUEST_RECHARGE_ADD_TO_CART_MESSAGE:return this.rechargeAddToCart(I.data);default:return null}}init(){window.addEventListener("message",this.rechargeMessagingHandler)}}var R=A}),Y("aejhc",function(o,F){S(o.exports,"handleOpenOrCloseEvent",function(){return x}),S(o.exports,"handleVideoPauseAndResumeEvents",function(){return I}),S(o.exports,"isTolstoyOpen",function(){return v});var m=p("50h3S"),y=p("eSOI5"),A=p("8ptJJ"),R=p("kCbDV");const x=({type:u,publishId:a})=>{if(!u||!a)return;const h=Date.now(),_=(0,y.getSessionId)();(0,y.pushTolstoyActivity)({publishId:a,timeStamp:h,type:u,sessionId:_})},I=u=>{const{videoPause:a,videoResume:h}=m.PLAYER_EVENTS,{publishId:_,playerType:U}=u.data;if(U!==R.EMBED_WIDGET||![a,h].includes(u.data.name))return;const k=Date.now(),G=(0,y.getSessionId)(),V=u.data.name===a?A.WIDGET_MESSAGES_EVENTS.PAUSE:A.WIDGET_MESSAGES_EVENTS.PLAY;(0,y.pushTolstoyActivity)({publishId:_,timeStamp:k,type:V,sessionId:G})},v=({publishId:u,sessionId:a})=>{if(!u||!a)return!1;const h=(0,y.getTolstoysActivity)()?.[u];if(!h?.length)return!1;const _=h[h.length-1];return _.type===A.WIDGET_MESSAGES_EVENTS.OPEN&&_.sessionId===a}})})();
