(function(){function U(L,O,T,h){Object.defineProperty(L,O,{get:T,set:h,enumerable:!0,configurable:!0})}var z=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},N=z.parcelRequire94c2,j=N.register;j("7ZKOP",function(L,O){U(L.exports,"initCollectionTileTemplates",function(){return I});var T=N("93NPo"),h=N("4lhba"),D=N("2Ha7R");const c=t=>{const r=t.getBoundingClientRect();return r.width>200&&r.height>200};function y(t){const r=window.getComputedStyle(t),a=[":hover",":focus",":active",":visited",":focus-within",":focus-visible",":target",":checked",":disabled"],o=[];for(const E of document.styleSheets){let w=[];try{w=E.cssRules||E.rules}catch{}const P=(_,R=null)=>{for(const v of _){if(v instanceof CSSMediaRule&&P(v.cssRules,v.conditionText||v.media.mediaText),!(v instanceof CSSStyleRule))continue;const M=v.selectorText.replace(new RegExp(a.join("|"),"g"),"").trim();if(M)try{M&&t.matches(M)&&o.push({selector:v.selectorText,style:v.style,cssText:v.cssText,originalRule:v,media:R?{condition:R,matches:window.matchMedia(R).matches}:null})}catch{}}};P(w)}const b=t.style.cssText?{selector:"inline",cssText:t.style.cssText}:null;return{computed:Object.fromEntries(Array.from(r).map(E=>[E,r.getPropertyValue(E)])),rules:b?[...o,b]:o}}function x(t){let r;const a=document.styleSheets;for(const o of a)if(!o.href){r=o;break}if(!r){const o=document.createElement("style");document.head.append(o),r=o.sheet}r.insertRule(t,r.cssRules.length)}function C(t){const{rules:r}=y(t);r.forEach(a=>{if(a.selector.includes("img")){const o=a.cssText.replace(/img\s*\+\s*img/,`img + .${h.PUBLIC_CLASSES.collectionTileHoverWrapper}`);if(o===a.cssText){const b=a.cssText.replace("img",`.${h.PUBLIC_CLASSES.collectionTileHoverWrapper}`);x(b)}else x(o)}})}const m=t=>{const r=t.attributes,a=new Set;for(const o of r){const b=String(o.value||"").split(/[,\s]+/).filter(Boolean);for(const E of b){const w=n(E);w&&a.add(w)}}return Array.from(a)},f=t=>{const r=t.attributes,a=new Set;for(const o of r){const b=String(o.value||"").split(/[,\s]+/).filter(Boolean);for(const E of b){const w=s(E);w&&a.add(w)}}return a};function n(t){try{return!t||!t.includes("//")?null:new URL(t?.startsWith("//")?`https:${t}`:t).pathname.split("/").pop().split(".").slice(0,-1).join(".")}catch{return null}}function s(t){if(typeof t!="string")return null;const r=t.toLowerCase(),a=/[\da-f]{8}(?:-[\da-f]{4}){3}-[\da-f]{12}/,o=r.match(a);return o?o[0]:null}const e=({config:t,project:r,collectionId:a},o)=>{if(!t||!r||!a)return;const b=(t.settings||h.DEFAULT_SETTINGS)?.playMode===h.PLAY_MODE.HOVER;Object.entries(t?.productsMap||{}).forEach(([E,w])=>{const P=w?.images?.map(g=>g.src)||w?.variants?.map(g=>g?.imageUrl);if(!P)return;const _=P.map(g=>n(g)),R=P.map(g=>s(g)).filter(Boolean);let v=o.filter(({element:g})=>!g?.parentElement?.querySelector(`.${h.PUBLIC_CLASSES.collectionTile}`)).map(({fileNames:g,fileUuidsSet:q,element:A,isLarge:F,externalElement:W})=>{let B=-1;return R.length>0&&(B=R.findLastIndex(H=>q.has(H))),B===-1&&(B=_.findLastIndex(H=>g.some(V=>V.includes(H)&&V.length<1.3*H.length))),{imgElement:A,externalImgElement:W,imageIndex:B,isLarge:F,fileName:_[B]}}).filter(({imageIndex:g})=>g!==-1);(0,T.logDevelopmentMessage)("filtered by src img elements",{imgElements:o,filteredImgElements:v,productFileNames:_,productUuids:R});const M=v.filter(({isLarge:g})=>g);if(M.length>0&&(v=M),v.length>0){const{externalImgElement:g}=v.at(b?0:-1),q=[...g.classList].join(" ").split(" ").filter(Boolean),A=document.createElement("div");if(A.innerHTML=`<tolstoy-collection-tile
            data-collection-id="${a}"
            class="${h.PUBLIC_CLASSES.collectionTile}"
            data-publish-id="${r.publishId}"
            data-product-id="${E}"
            style="mix-blend-mode: normal !important;"
          ></tolstoy-collection-tile>`,g.parentElement)if(b){C(g);const{width:F,height:W}=g.getBoundingClientRect();A.style.width=`${F}px`,A.style.height=`${W}px`,A.classList.add(h.PUBLIC_CLASSES.collectionTileHoverWrapper,...q),A.firstChild.style.zIndex="0",g.style.display="none",g.parentElement.insertBefore(A,g),A.append(g)}else q&&A.firstChild.classList.add(...q),A.firstChild.style.zIndex="3",g.parentElement.insertBefore(A.firstChild,g)}})},l=(t,r,a)=>{if(!t||t.length===0)return;t.forEach(b=>r.add(b));const o=i(t);u(o,a)},i=t=>t.map(r=>({element:r,externalElement:(0,D.getImgExternalElement)(r),isLarge:c(r),fileNames:m(r),fileUuidsSet:f(r)})).reverse(),p=(t,r)=>{if(!r)return t;const a=r.split(",").flatMap(b=>[b,`${b} img`]).join(","),o=document.querySelectorAll(a);return t.filter(b=>[...o].some(E=>E.contains(b)))},u=(t,r)=>{r.forEach(a=>e(a,t))},S=t=>t.closest(".cart-drawer, #cart-drawer, .autocomplete, .header__nav, .upcart-cart, #CartPopup"),$=(t,r,a)=>{const{playerSettings:o,widgetSettings:b}=a[0].project,E=b.collectionTileSettings.playMode===h.PLAY_MODE.HOVER,w=o.gallerySelector||"",P=o.galleryImageSelector||"",_=E&&o.galleryImageSecondarySelector,R=(E?_:P)||w,v=t.filter(q=>!r.has(q)),M=v.filter(q=>!S(q)),g=p(M,R);return R&&(0,T.logDevelopmentMessage)("filter new images with selector",{playerSettings:o,widgetSettings:b,imgElements:t,unprocessedImages:v,validImages:M,filteredImages:g,processedImageElements:r,filterSelector:R}),g},d=(t,r,a)=>{if(!t||t.length===0)return;const o=$(t,r,a);o.length!==0&&((0,T.logDevelopmentMessage)("processImages",{imgElements:t,newImages:o}),l(o,r,a))},I=async t=>{if(!t?.length||document.querySelector(`.${h.PUBLIC_CLASSES.collectionTile}`))return;const r=new Set,a=b=>{d(b,r,t)},o=await(0,D.waitForImages)(3e3,1e4,a);d(o,r,t)}}),j("2Ha7R",function(L,O){U(L.exports,"waitForImages",function(){return C}),U(L.exports,"getImgExternalElement",function(){return m});var T=N("IsMyM");const h=(f,n,s,e=null)=>{if(!f||f.length===0)return;f.forEach(i=>n.add(i));const l=Array.from(n);e&&e(l),s(l)},D=(f,n,s=null)=>setInterval(()=>{const l=Array.from((0,T.querySelectorAllDeep)("img")).filter(i=>!f.has(i));l.length>0&&h(l,f,n,s)},2e3),c=(f,n,s,e=null)=>{const l=new IntersectionObserver(i=>{let p=!1;i.forEach(u=>{if(u.isIntersecting){const $=u.target.querySelectorAll("img");if($.length>0){const d=Array.from($).filter(I=>!f.has(I));d.length>0&&(h(d,f,n,e),p=!0)}}}),p&&(s.current=Date.now())},{root:null,rootMargin:"100px",threshold:.1});return l.observe(document.body),l},y=(f,n,s,e,l=null)=>{const i=new MutationObserver(p=>{let u=!1;const S=[];if(p.forEach($=>{$.type==="childList"?(Array.from($.addedNodes).forEach(d=>{if(d.nodeName==="IMG")S.push(d),u=!0,e.observe(d);else if(d.querySelectorAll){const I=Array.from(d.querySelectorAll("img"));I.length>0&&(S.push(...I),u=!0,I.forEach(t=>e.observe(t)))}d.nodeType===1&&e.observe(d)}),Array.from($.removedNodes).forEach(d=>{(d.nodeName==="IMG"||d.querySelectorAll&&d.querySelectorAll("img").length>0)&&(u=!0)})):$.type==="attributes"&&$.attributeName==="src"&&(u=!0)}),u)if(s.current=Date.now(),S.length>0)h(S,f,n,l);else{const d=Array.from((0,T.querySelectorAllDeep)("img")).filter(I=>!f.has(I));d.length>0&&h(d,f,n,l)}});return i.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["src"]}),i},x=(f,n,s,e,l)=>{let i=null;const p={current:Date.now()};function u(){Date.now()-p.current>=f?(clearTimeout(n),clearTimeout(i),l(s)):i=setTimeout(u,100)}return i=setTimeout(u,100),{timeoutId:i,lastChangeTimeRef:p}};function C(f=3e3,n=1e4,s=null){let e=Array.from((0,T.querySelectorAllDeep)("img"));const l=new Set;let i=null,p=null,u=null;return new Promise($=>{i=$,e.length>0&&(e.forEach(t=>l.add(t)),s&&s(e),$(e)),p=setTimeout(()=>{e=Array.from((0,T.querySelectorAllDeep)("img")),e.forEach(t=>l.add(t)),s&&s(e),$(e)},n),u=x(f,p,e,l,$).lastChangeTimeRef,D(l,i,s);const I=c(l,i,u,s);y(l,i,u,I,s)})}const m=f=>{let n=f;if(n){if(n.parentElement?.tagName==="PICTURE"&&(n=f.parentElement),!n.parentElement){const s=n?.shadowRoot?.host||n?.parentNode?.host;if(s)n=s;else if(f.parentElement)n=f;else return}return n}}}),j("IsMyM",function(L,O){U(L.exports,"querySelectorAllDeep",function(){return h});var T=N("jVnA7");function h(n,s=document,e=null){return c(n,!0,s,e)}function D(n,s=document,e=null){return c(n,!1,s,e)}function c(n,s,e,l=null){n=(0,T.normalizeSelector)(n);let i=e.querySelector(n);return document.head.createShadowRoot||document.head.attachShadow?!s&&i?i:x(n,",").reduce((u,S)=>{if(!s&&u)return u;const $=x(S.replace(/^\s+/g,"").replace(/\s*([>+~]+)\s*/g,"$1")," ").filter(a=>!!a).map(a=>x(a,">")),d=$.length-1,I=$[d][$[d].length-1],t=f(I,e,l),r=y($,d,e);return s?(u=u.concat(t.filter(r)),u):(u=t.find(r),u||null)},s?[]:null):s?e.querySelectorAll(n):i}function y(n,s,e){return l=>{let i=s,p=l,u=!1;for(;p&&!C(p);){let S=!0;if(n[i].length===1)S=p.matches(n[i]);else{const $=[].concat(n[i]).reverse();let d=p;for(const I of $){if(!d||!d.matches(I)){S=!1;break}d=m(d,e)}}if(S&&i===0){u=!0;break}S&&i--,p=m(p,e)}return u}}function x(n,s){return n.match(/\\?.|^$/g).reduce((e,l)=>(l==='"'&&!e.sQuote?(e.quote^=1,e.a[e.a.length-1]+=l):l==="'"&&!e.quote?(e.sQuote^=1,e.a[e.a.length-1]+=l):!e.quote&&!e.sQuote&&l===s?e.a.push(""):e.a[e.a.length-1]+=l,e),{a:[""]}).a}function C(n){return n.nodeType===Node.DOCUMENT_FRAGMENT_NODE||n.nodeType===Node.DOCUMENT_NODE}function m(n,s){const e=n.parentNode;return e&&e.host&&e.nodeType===11?e.host:e===s?null:e}function f(n=null,s,e=null){let l=[];if(e)l=e;else{const i=function(p){for(let u=0;u<p.length;u++){const S=p[u];l.push(S),S.shadowRoot&&i(S.shadowRoot.querySelectorAll("*"))}};s.shadowRoot&&i(s.shadowRoot.querySelectorAll("*")),i(s.querySelectorAll("*"))}return n?l.filter(i=>i.matches(n)):l}}),j("jVnA7",function(L,O){U(L.exports,"normalizeSelector",function(){return T});function T(h){function D(){x&&(c.length>0&&/^[~+>]$/.test(c[c.length-1])&&c.push(" "),c.push(x))}var c=[],y,x,C,m=[0],f=0,n,s=/(?:[^\\]|(?:^|[^\\])(?:\\\\)+)$/,e=/^\s+$/,l=[/\s+|\/\*|["'>~+[(]/g,/\s+|\/\*|["'[\]()]/g,/\s+|\/\*|["'[\]()]/g,null,/\*\//g];for(h=h.trim();;)if(x="",C=l[m[m.length-1]],C.lastIndex=f,y=C.exec(h),y)if(n=f,f=C.lastIndex,n<f-y[0].length&&(x=h.substring(n,f-y[0].length)),m[m.length-1]<3){if(D(),y[0]==="[")m.push(1);else if(y[0]==="(")m.push(2);else if(/^["']$/.test(y[0]))m.push(3),l[3]=new RegExp(y[0],"g");else if(y[0]==="/*")m.push(4);else if(/^[\])]$/.test(y[0])&&m.length>0)m.pop();else if(/^(?:\s+|[~+>])$/.test(y[0])&&(c.length>0&&!e.test(c[c.length-1])&&m[m.length-1]===0&&c.push(" "),m[m.length-1]===1&&c.length===5&&c[2].charAt(c[2].length-1)==="="&&(c[4]=" "+c[4]),e.test(y[0])))continue;c.push(y[0])}else c[c.length-1]+=x,s.test(c[c.length-1])&&(m[m.length-1]===4&&(c.length<2||e.test(c[c.length-2])?c.pop():c[c.length-1]=" ",y[0]=""),m.pop()),c[c.length-1]+=y[0];else{x=h.substr(f),D();break}return c.join("").trim()}})})();
