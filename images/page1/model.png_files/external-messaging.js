(function(){function $(o){Object.defineProperty(o,"__esModule",{value:!0,configurable:!0})}function a(o,i,c,t){Object.defineProperty(o,i,{get:c,set:t,enumerable:!0,configurable:!0})}var g=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},r=g.parcelRequire94c2,p=r.register;p("dc422",function(o,i){$(o.exports),a(o.exports,"default",function(){return I});var c=r("6QfcD"),t=r("kK0IS"),n=r("aEodP"),l=r("kHyIS"),d=r("519R9"),_=r("eSOI5");const T=y=>{const{eventName:e}=y;if(!e){console.error("eventName is required");return}if(!l.ALLOWED_EXTERNAL_EVENTS_TO_POST.has(e)){console.error(`${e} is not a valid eventName`);return}return!0};class S{postMessage=(e={})=>{T(e)&&d.default.postMessage(e)};closePlayer(){d.default.postMessage({eventName:n.INTERNAL_EVENTS.closePlayer})}changeEmail(e){window.tolstoyUser=e,d.default.postMessage({eventName:n.INTERNAL_EVENTS.userEmailUpdate,email:e})}async identify(e={}){const{email:f,userId:u}=e;if(!f&&!u){console.error("No email or userId");return}try{f&&this.changeEmail(f),u&&(e.userId=u.toString()),e.appKey=(0,c.getAppKey)();const s=await(0,t.postUserIdentification)(e);(0,_.setIdentifyInfoId)(s?.id)}catch(s){console.error("Error occurred while updating identify info:",s),window.tolstoyCaptureError?.(s,"Error occurred while updating identify info:"),(0,_.removeIdentifyInfoId)()}}}const E=new S;Object.freeze(E);var I=E}),p("kHyIS",function(o,i){a(o.exports,"EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return c}),a(o.exports,"EXTERNAL_EVENTS_TO_POST",function(){return t}),a(o.exports,"ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return n}),a(o.exports,"ALLOWED_EXTERNAL_EVENTS_TO_POST",function(){return l});const c={addToCart:"tolstoy_add_to_cart",spotlightCarouselQuickShopClick:"tolstoy_spotlight_carousel_quick_shop_click",productCardClick:"tolstoy_product_card_click"},t={addToCartSuccess:"tolstoy_add_to_cart_success",addToCartError:"tolstoy_add_to_cart_error",acceptCookiePolicy:"tolstoy_accept_cookie_policy",rejectCookiePolicy:"tolstoy_reject_cookie_policy",tolstoyZIndexChange:"tolstoy_z_index_change",urlLocaleUpdate:"tolstoy_url_locale_update",productUpdate:"tolstoy_product_update"},n=Object.values(c),l=new Set([t.addToCartSuccess,t.addToCartError,t.acceptCookiePolicy,t.rejectCookiePolicy,t.tolstoyZIndexChange,t.urlLocaleUpdate,t.productUpdate])})})();
