(function(){function N(t){Object.defineProperty(t,"__esModule",{value:!0,configurable:!0})}function c(t,u,a,n){Object.defineProperty(t,u,{get:a,set:n,enumerable:!0,configurable:!0})}var b=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},e=b.parcelRequire94c2,T=e.register;T("1xZaa",function(t,u){N(t.exports),c(t.exports,"default",function(){return $});var a=e("aEodP"),n=e("519R9"),p=e("lY4N9"),o=e("eLQEc"),f=e("gIcXF");class E{disableCartDefault(){n.default.postMessage({eventName:a.INTERNAL_EVENTS.addToCartDisableDefault})}internalMessagingHandler=i=>{switch(i.data.eventName){case a.INTERNAL_EVENTS.playerReady:return this.disableCartDefault();case a.INTERNAL_EVENTS.productCardClick:return(0,o.openTapcartProduct)(i.data);case a.INTERNAL_EVENTS.addToCart:return(0,o.addToTapcartCart)(i.data);default:return null}};initInternalMessagingSubscriptions(){n.default.subscribeMultipleEvents({eventNames:f.INTERNAL_MESSAGES_TO_SUBSCRIBE,callback:this.internalMessagingHandler})}init(){(0,p.getIsTapcart)()&&(this.initInternalMessagingSubscriptions(),(0,o.updateCartAttributes)())}}const l=new E;Object.freeze(l);var $=l}),T("eLQEc",function(t,u){c(t.exports,"openTapcartProduct",function(){return $}),c(t.exports,"addToTapcartCart",function(){return i}),c(t.exports,"updateCartAttributes",function(){return g});var a=e("kK0IS"),n=e("6QfcD"),p=e("hP9Uw"),o=e("aEodP"),f=e("519R9"),E=e("lY4N9"),l=e("gIcXF");const $=({productId:r,variantId:d})=>{const s={productId:String(r)};return d&&(s.variantId=String(d)),window.Tapcart.actions.openProduct(s)},I=r=>{const s=setTimeout(()=>{f.default.postMessage({...r,eventName:o.INTERNAL_EVENTS.addToCartError})},4e3);window.Tapcart.registerEventHandler(l.TAPCART_EVENTS.cartUpdated,()=>{clearTimeout(s),f.default.postMessage({...r,eventName:o.INTERNAL_EVENTS.addToCartSuccess})})},i=async r=>{const{variantId:d,productId:s}=r;try{I(r),window.Tapcart.actions.addToCart({lineItems:[{variantId:String(d||s),quantity:1}]})}catch(S){return f.default.postMessage({...r,error:S,eventName:o.INTERNAL_EVENTS.addToCartError})}},g=()=>{try{const r=(0,E.getTapcartDeviceId)();if(!r)return;const s=[...window?.Tapcart?.variables?.cart?.attributes||[],{key:p.SHOPIFY_CART_ATTRIBUTES.tolstoyAnonymousId,value:r}];window?.Tapcart?.actions?.updateCartAttributes?.({attributes:s})}catch(r){(0,a.createPlayerEvent)({text:r?.message,parentUrl:window.location.href,appKey:(0,n.getAppKey)(),source:"tapcart",eventName:"widgetError",timestamp:new Date().toISOString()})}}}),T("hP9Uw",function(t,u){c(t.exports,"ADD_TO_CART_ERROR_DESCRIPTIONS",function(){return a}),c(t.exports,"SHOPIFY_CART_ATTRIBUTES",function(){return n});const a={itemSoldOut:"itemSoldOut"},n={tolstoyAnonymousId:"__tolstoyAnonymousId"}}),T("gIcXF",function(t,u){c(t.exports,"INTERNAL_MESSAGES_TO_SUBSCRIBE",function(){return n}),c(t.exports,"TAPCART_EVENTS",function(){return p});var a=e("aEodP");const n=[a.INTERNAL_EVENTS.addToCart,a.INTERNAL_EVENTS.playerReady,a.INTERNAL_EVENTS.productCardClick],p={cartUpdated:"cart/updated"},o="custom-blocks.tapcart.com"})})();
