(function(){function f(r){Object.defineProperty(r,"__esModule",{value:!0,configurable:!0})}function d(r,p,t,s){Object.defineProperty(r,p,{get:t,set:s,enumerable:!0,configurable:!0})}var F=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},o=F.parcelRequire94c2,l=o.register;l("bDaQR",function(r,p){f(r.exports),d(r.exports,"default",function(){return E});var t=o("aEodP"),s=o("519R9"),$=o("j2Krx"),n=o("jB6VW");const R={},N={};class C{constructor(){this.isOpenCommerceStore=!!window.CQuotient,this.siteId=window.CQuotient?.siteId,this.locale=(0,$.formatLocale)(window.CQuotient?.locale),this.apiBaseUrl="",this.clientId="",this.currencyCode=window.pageContext?.ecommerce?.currencyCode}fetchProduct=async e=>{const a=`${this.apiBaseUrl}/products/${e}`,u=new URL(a);u.searchParams.append("client_id",this.clientId),u.searchParams.append("locale",this.locale),u.searchParams.append("currency",this.currencyCode),u.searchParams.append("expand","prices");try{const c=await(await fetch(u)).json();return(0,$.formatProduct)(c)}catch(i){console.error("Error fetching product price",i)}};getProduct=async e=>{if(R[e])return R[e];if(N[e])return N[e];const a=this.fetchProduct(e);N[e]=a;const u=await a;return R[e]=u,delete N[e],u};onRequestProductsUpdateMessage=async({productIds:e})=>{const u=[...new Set(e)].map(c=>this.getProduct(c)),i=(await Promise.all(u)).filter(Boolean);for(const c of i)s.default.postMessage({eventName:t.INTERNAL_EVENTS.productUpdateResponse,product:c,isProductUpdateResponse:!0})};postUrlLocaleUpdateIfNeeded(e){this.locale!==e&&s.default.postMessage({eventName:t.INTERNAL_EVENTS.urlLocaleUpdate,urlLocale:this.locale})}postIsNonBaseCurrencyIfNeeded(e){this.currencyCode!==e&&s.default.postMessage({eventName:t.INTERNAL_EVENTS.isNonBaseCurrency,currencyCode:this.currencyCode})}onOpenCommerceSettingsUpdate({openCommerceSettings:e}){const{apiVersion:a,clientId:u,baseLocale:i,baseCurrency:c}=e;this.apiBaseUrl=`https://${window.location.host}/s/${this.siteId}/dw/shop/${a}`,this.clientId=u,this.postUrlLocaleUpdateIfNeeded(i),this.postIsNonBaseCurrencyIfNeeded(c)}internalMessagingHandler=e=>{switch(e.data.eventName){case t.INTERNAL_EVENTS.openCommerceSettingsUpdate:return this.onOpenCommerceSettingsUpdate(e.data);case t.INTERNAL_EVENTS.requestProductsUpdate:return this.onRequestProductsUpdateMessage(e.data);default:return null}};initInternalMessagingSubscriptions(){s.default.subscribeMultipleEvents({eventNames:n.INTERNAL_MESSAGES_TO_SUBSCRIBE,callback:this.internalMessagingHandler})}init(){this.isOpenCommerceStore&&this.initInternalMessagingSubscriptions()}}var E=new C}),l("j2Krx",function(r,p){d(r.exports,"formatProduct",function(){return s}),d(r.exports,"formatLocale",function(){return $});var t=o("gI2VZ");const s=n=>({id:n.id,price:n.price,compareAtPrice:n.price,currencyCode:n.currency,currencySymbol:t.CURRENCY_SYMBOL_MAP[n.currency],variants:[{price:n.price,compareAtPrice:n.price}]}),$=(n="")=>n.replace("_","-")}),l("gI2VZ",function(r,p){d(r.exports,"CURRENCY_SYMBOL_MAP",function(){return t});const t={USD:"$",CAD:"CA$",EUR:"\u20AC",AED:"\u062F.\u0625.\u200F",AFN:"\u060B",ALL:"Lek",AMD:"\u0564\u0580.",ARS:"$",AUD:"AU$",AZN:"\u043C\u0430\u043D.",BAM:"KM",BDT:"\u09F3",BGN:"\u043B\u0432.",BHD:"\u062F.\u0628.\u200F",BIF:"FBu",BND:"$",BOB:"Bs",BRL:"R$",BWP:"P",BYN:"\u0440\u0443\u0431.",BZD:"$",CDF:"FrCD",CHF:"CHF",CLP:"$",CNY:"CN\xA5",COP:"$",CRC:"\u20A1",CVE:"CV$",CZK:"K\u010D",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"\u062F.\u062C.\u200F",EEK:"kr",EGP:"\u062C.\u0645.\u200F",ERN:"Nfk",ETB:"Br",GBP:"\xA3",GEL:"GEL",GHS:"GH\u20B5",GNF:"FG",GTQ:"Q",HKD:"$",HNL:"L",HRK:"kn",HUF:"Ft",IDR:"Rp",ILS:"\u20AA",INR:"\u20B9",IQD:"\u062F.\u0639.\u200F",IRR:"\uFDFC",ISK:"kr",JMD:"$",JOD:"\u062F.\u0623.\u200F",JPY:"\uFFE5",KES:"Ksh",KHR:"\u17DB",KMF:"FC",KRW:"\u20A9",KWD:"\u062F.\u0643.\u200F",KZT:"\u0442\u04A3\u0433.",LBP:"\u0644.\u0644.\u200F",LKR:"SL Re",LTL:"Lt",LVL:"Ls",LYD:"\u062F.\u0644.\u200F",MAD:"\u062F.\u0645.\u200F",MDL:"MDL",MGA:"MGA",MKD:"MKD",MMK:"K",MOP:"MOP$",MUR:"MURs",MXN:"MX$",MYR:"RM",MZN:"MTn",NAD:"N$",NGN:"\u20A6",NIO:"C$",NOK:"kr",NPR:"\u0928\u0947\u0930\u0942",NZD:"$",OMR:"\u0631.\u0639.\u200F",PAB:"B/.",PEN:"S/.",PHP:"\u20B1",PKR:"\u20A8",PLN:"z\u0142",PYG:"\u20B2",QAR:"\u0631.\u0642.\u200F",RON:"RON",RSD:"\u0434\u0438\u043D.",RUB:"\u20BD.",RWF:"FR",SAR:"\u0631.\u0633.\u200F",SDG:"SDG",SEK:"kr",SGD:"$",SOS:"Ssh",SYP:"\u0644.\u0633.\u200F",THB:"\u0E3F",TND:"\u062F.\u062A.\u200F",TOP:"T$",TRY:"TL",TTD:"$",TWD:"NT$",TZS:"TSh",UAH:"\u20B4",UGX:"USh",UYU:"$",UZS:"UZS",VEF:"Bs.F.",VND:"\u20AB",XAF:"FCFA",XOF:"CFA",YER:"\u0631.\u064A.\u200F",ZAR:"R",ZMK:"ZK",ZWL:"ZWL$"}}),l("jB6VW",function(r,p){d(r.exports,"INTERNAL_MESSAGES_TO_SUBSCRIBE",function(){return s});var t=o("aEodP");const s=[t.INTERNAL_EVENTS.openCommerceSettingsUpdate,t.INTERNAL_EVENTS.requestProductsUpdate]})})();
